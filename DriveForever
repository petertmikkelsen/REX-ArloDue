from time import sleep

import RobotDue

# Create a robot object and initialize
arlo = RobotDue.Robot()

lastturn = True #variable for when the robot should turn any direction (left or right)

driving = False

while(True):
  pings = [] #front, back, left, right
  for i in range(4):
    pings.append(arlo.read_sensor(i))
    sleep(0.05)
  pings[0] = (pings[0] < 750)
  pings[2] = (pings[2] < 500)
  pings[3] = (pings[3] < 500)
  if pings[2] and not pings[3]: #left has object, right has no object
    print("detected object to the left, turning right")
    if (driving):
      arlo.stop()
      driving = False
      sleep(0.1)
    arlo.Turn(False) #turn right
  elif pings[3] and not pings[2]: #right has object, left has no object
    print("detected object to the right, turning left")
    if (driving):
      arlo.stop()
      driving = False
      sleep(0.1)
    arlo.Turn() #turn left
  elif pings[2] and pings[3]: #all 3 front sensors see objects
    print("tunnel or wall detected, turning around")
    if (driving):
      arlo.stop()
      driving = False
      sleep(0.1)
    arlo.Turn(degrees = 180) #turn around      
  elif pings[0]: # object in front, not to the sides
    print("object ahead spotted, turning to the side")
    if (driving):
      arlo.stop()
      driving = False
      sleep(0.1)
    arlo.Turn(lastturn) #turn left or right, next time this is called turn the other direction
    lastturn = not(lastturn)
  elif not (driving):
    print("no objects spotted, driving forward")
    driving = True
    arlo.Forward(compensate = True, stop = False)
    #print(arlo.go_diff(64, 70, 1, 1))
    sleep(0.1)
  
  
print("Finished")
